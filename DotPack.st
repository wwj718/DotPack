BorderedMorph subclass: #DotPack	instanceVariableNames: 'cells'	classVariableNames: ''	poolDictionaries: ''	category: 'DotPack'!!DotPack commentStamp: 'wwj718 8/21/2022 08:40' prior: 0!A DotPack simulator.DotPack new openInWorld.!!DotPack methodsFor: 'drawing' stamp: 'wwj718 8/21/2022 11:14'!backgroundColor: aColorcells do: [:each | each color: aColor]! !!DotPack methodsFor: 'drawing' stamp: 'wwj718 8/21/2022 13:57'!clearself backgroundColor: Color black."cells do: [:each| each turnOff.]"! !!DotPack methodsFor: 'drawing' stamp: 'wwj718 8/21/2022 11:05'!x: xCoord y: yCoord^ cells at: xCoord at: yCoord.! !!DotPack methodsFor: 'drawing' stamp: 'wwj718 8/21/2022 11:12'!x: xCoord y: yCoord color: aColor(cells at: xCoord at: yCoord) color: aColor.! !!DotPack methodsFor: 'demo' stamp: 'wwj718 8/21/2022 14:09'!randomEachcells do: [:each| each color: Color random]! !!DotPack methodsFor: 'demo' stamp: 'wwj718 8/21/2022 11:57'!snowCrashcells do: [:each| 2 random =1 ifTrue:[each color:Color white] ifFalse:[each color:Color black]]! !!DotPack methodsFor: 'initialization' stamp: 'wwj718 8/21/2022 08:41'!cellsPerSide	"The number of cells along each side of the DotPack"	^ 16! !!DotPack methodsFor: 'initialization' stamp: 'wwj718 8/21/2022 11:08'!initialize| backgroundImage height overallBorderWidth sampleCell width |super initialize.sampleCell := DotPackCell new.width := sampleCell width.height := sampleCell height.overallBorderWidth := 2 * self borderWidth.self position: 140 @ 268.self extent: (width * self cellsPerSide) @ (height * self cellsPerSide) + overallBorderWidth.cells := Matrix new: self cellsPerSide tabulate: [:i :j | self newCellAt: i at: j]."background image"backgroundImage :=  (Form fromFileNamed: 'dotpack-removebg.png' ) asMorph.backgroundImage position: 100 @ 100.backgroundImage addMorph: self.backgroundImage openInWorld.! !!DotPack methodsFor: 'initialization' stamp: 'wwj718 8/21/2022 09:09'!newCellAt: i at: j 	"Create a cell for position (i,j) and add it to my on-screen	representation at the appropriate screen position.  Answer the new cell"	| c origin |	c := DotPackCell new.	origin := self innerBounds origin.	self addMorph: c.	c position: ((i - 1) * c width) @ ((j - 1) * c height) + origin.	^ c! !!DotPack methodsFor: 'stepping and presenter' stamp: 'wwj718 8/21/2022 11:58'!stepself snowCrash! !!DotPack methodsFor: 'as yet unclassified' stamp: 'wwj718 8/21/2022 15:04'!indexOf: anElement^ cells indexOf: anElement! !!DotPack methodsFor: 'as yet unclassified' stamp: 'wwj718 8/21/2022 11:59'!stepTime^ 100! !Morph subclass: #DotPackCell	instanceVariableNames: ''	classVariableNames: ''	poolDictionaries: ''	category: 'DotPack'!!DotPackCell methodsFor: 'initialization' stamp: 'wwj718 8/21/2022 13:58'!initializesuper initialize. self	borderWidth: 1;	borderColor: Color black;	bounds: (0 @ 0 corner: 20.5 @ 20.5).! !!DotPackCell methodsFor: 'event handling' stamp: 'wwj718 8/21/2022 14:06'!handlesMouseDown: evt		^ true.! !!DotPackCell methodsFor: 'event handling' stamp: 'wwj718 8/21/2022 14:20'!handlesMouseOver: evt
^ true! !!DotPackCell methodsFor: 'event handling' stamp: 'wwj718 8/21/2022 14:13'!mouseDown: anEvent	"Transcript show: anEvent."	self color: Color random.! !!DotPackCell methodsFor: 'event handling' stamp: 'wwj718 8/21/2022 15:12'!mouseEnter: evt		"self color: Color random."		"Transcript show: evt; cr."				self assuredPlayer sayText:  ((self owner indexOf: self) asString copyReplaceAll: '@' with: ',').! !!DotPackCell methodsFor: 'event handling' stamp: 'wwj718 8/21/2022 14:48'!mouseLeave: evt		"Transcript show: 'leave'; cr"		"self color: Color random"		self assuredPlayer sayText: ''.! !TestCase subclass: #DotPackTest	instanceVariableNames: 'pack'	classVariableNames: ''	poolDictionaries: ''	category: 'DotPack'!!DotPackTest methodsFor: 'as yet unclassified' stamp: 'wwj718 8/21/2022 19:41'!setUp	pack := DotPack new.! !!DotPackTest methodsFor: 'as yet unclassified' stamp: 'wwj718 8/21/2022 19:43'!tearDown	pack owner delete.! !!DotPackTest methodsFor: 'as yet unclassified' stamp: 'wwj718 8/21/2022 19:45'!testNoError	self assert: (1=1).	self shouldnt: [pack] raise: Error.! !